import{_ as e,c as p,b as t,a as n,d as l,e as r,r as i,o}from"./app-CHYapVbF.js";const c={},d={href:"https://gofrp.org/zh-cn/docs/examples/multiple-ssh-over-same-port/",target:"_blank",rel:"noopener noreferrer"};function u(m,s){const a=i("ExternalLinkIcon");return o(),p("div",null,[s[1]||(s[1]=t(`<p>通过使用 tcpmux 类型的代理，您可以实现多个 SSH 服务通过同一端口进行暴露。这种方法还适用于任何支持 HTTP Connect 代理连接方式的客户端，以实现端口的复用。 步骤</p><h2 id="_1-在具有公网-ip-的机器上部署-frps" tabindex="-1"><a class="header-anchor" href="#_1-在具有公网-ip-的机器上部署-frps"><span>1.在具有公网 IP 的机器上部署 frps</span></a></h2><p>修改 frps.toml 文件以包含以下内容（这里使用了最简化的配置）：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">bindPort <span class="token operator">=</span> <span class="token number">7000</span></span>
<span class="line">tcpmuxHTTPConnectPort <span class="token operator">=</span> <span class="token number">5002</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-在内网机器-a-上部署-frpc" tabindex="-1"><a class="header-anchor" href="#_2-在内网机器-a-上部署-frpc"><span>2.在内网机器 A 上部署 frpc</span></a></h2><p>创建 frpc 配置文件，例如 frpc.toml，然后将以下内容添加到配置文件中：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">serverAddr <span class="token operator">=</span> <span class="token string">&quot;x.x.x.x&quot;</span></span>
<span class="line">serverPort <span class="token operator">=</span> <span class="token number">7000</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">[</span><span class="token punctuation">[</span>proxies<span class="token punctuation">]</span><span class="token punctuation">]</span></span>
<span class="line">name <span class="token operator">=</span> <span class="token string">&quot;ssh1&quot;</span></span>
<span class="line"><span class="token builtin class-name">type</span> <span class="token operator">=</span> <span class="token string">&quot;tcpmux&quot;</span></span>
<span class="line">multiplexer <span class="token operator">=</span> <span class="token string">&quot;httpconnect&quot;</span></span>
<span class="line">customDomains <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;machine-a.example.com&quot;</span><span class="token punctuation">]</span></span>
<span class="line">localIP <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1&quot;</span></span>
<span class="line">localPort <span class="token operator">=</span> <span class="token number">22</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-在内网机器-b-上部署另一个-frpc" tabindex="-1"><a class="header-anchor" href="#_3-在内网机器-b-上部署另一个-frpc"><span>3.在内网机器 B 上部署另一个 frpc</span></a></h2><p>创建 frpc 配置文件，例如 frpc.toml，然后将以下内容添加到配置文件中：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">serverAddr <span class="token operator">=</span> <span class="token string">&quot;x.x.x.x&quot;</span></span>
<span class="line">serverPort <span class="token operator">=</span> <span class="token number">7000</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">[</span><span class="token punctuation">[</span>proxies<span class="token punctuation">]</span><span class="token punctuation">]</span></span>
<span class="line">name <span class="token operator">=</span> <span class="token string">&quot;ssh2&quot;</span></span>
<span class="line"><span class="token builtin class-name">type</span> <span class="token operator">=</span> <span class="token string">&quot;tcpmux&quot;</span></span>
<span class="line">multiplexer <span class="token operator">=</span> <span class="token string">&quot;httpconnect&quot;</span></span>
<span class="line">customDomains <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;machine-b.example.com&quot;</span><span class="token punctuation">]</span></span>
<span class="line">localIP <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1&quot;</span></span>
<span class="line">localPort <span class="token operator">=</span> <span class="token number">22</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-通过-ssh-proxycommand-访问内网机器-a" tabindex="-1"><a class="header-anchor" href="#_4-通过-ssh-proxycommand-访问内网机器-a"><span>4.通过 SSH ProxyCommand 访问内网机器 A</span></a></h2><p>使用 SSH ProxyCommand 访问内网机器 A，假设用户名为 test。使用以下命令：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token string">&#39;proxycommand socat - PROXY:x.x.x.x:%h:%p,proxyport=5002&#39;</span> test@machine-a.example.com</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>要访问内网机器 B，只需更改域名，假设用户名仍然为 test：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">ssh</span> <span class="token parameter variable">-o</span> <span class="token string">&#39;proxycommand socat - PROXY:x.x.x.x:%h:%p,proxyport=5002&#39;</span> test@machine-b.example.com</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>通过按照以上步骤进行配置，您可以实现多个 SSH 服务复用同一端口，以便在具有公网 IP 的机器上进行访问。</p>`,16)),n("p",null,[n("a",d,[s[0]||(s[0]=l("原文链接")),r(a)])])])}const v=e(c,[["render",u],["__file","exp_multi_ssh.html.vue"]]),b=JSON.parse('{"path":"/blogs/frp/gofrp/exp_multi_ssh.html","title":"Frp 多个 SSH 服务复用同一端口","lang":"en-US","frontmatter":{"title":"Frp 多个 SSH 服务复用同一端口","date":"2025/3/15","tags":["gofrp"],"categories":["frp","gofrp"]},"headers":[{"level":2,"title":"1.在具有公网 IP 的机器上部署 frps","slug":"_1-在具有公网-ip-的机器上部署-frps","link":"#_1-在具有公网-ip-的机器上部署-frps","children":[]},{"level":2,"title":"2.在内网机器 A 上部署 frpc","slug":"_2-在内网机器-a-上部署-frpc","link":"#_2-在内网机器-a-上部署-frpc","children":[]},{"level":2,"title":"3.在内网机器 B 上部署另一个 frpc","slug":"_3-在内网机器-b-上部署另一个-frpc","link":"#_3-在内网机器-b-上部署另一个-frpc","children":[]},{"level":2,"title":"4.通过 SSH ProxyCommand 访问内网机器 A","slug":"_4-通过-ssh-proxycommand-访问内网机器-a","link":"#_4-通过-ssh-proxycommand-访问内网机器-a","children":[]}],"git":{"createdTime":null,"updatedTime":null,"contributors":[]},"filePathRelative":"blogs/frp/gofrp/exp_multi_ssh.md"}');export{v as comp,b as data};
